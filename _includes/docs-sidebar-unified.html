{% comment %}
  Unified sidebar that handles both default and i18n pages
{% endcomment %}

{% assign lang = page.lang | default: site.default_lang %}
{% assign t = site.data.translations[lang].nav | default: site.data.translations[lang] %}
{% assign routes = site.data.i18n_routes[lang] %}
{% capture base_path %}{{ site.baseurl }}{% endcapture %}

<!-- Sidebar -->
<aside class="docs-sidebar">
    <h3>{{ t.getting_started }}</h3>
    <ul>
        <li><a href="{{ base_path }}{{ routes.docs | default: '/docs/' }}" {% if page.url == routes.docs or page.url == '/docs/' %}class="active"{% endif %}>{{ t.introduction }}</a></li>
        <li><a href="{{ base_path }}{{ routes.why_pivotphp | default: '/docs/why-pivotphp/' }}" {% if page.url contains 'why-pivotphp' %}class="active"{% endif %}>{{ t.why_pivotphp | default: 'Why PivotPHP?' }}</a></li>
        <li><a href="{{ base_path }}{{ routes.installation | default: '/docs/installation/' }}" {% if page.url contains 'installation' %}class="active"{% endif %}>{{ t.installation }}</a></li>
        <li><a href="{{ base_path }}{{ routes.quickstart | default: '/docs/quickstart/' }}" {% if page.url contains 'quickstart' %}class="active"{% endif %}>{{ t.quick_start }}</a></li>
        <li><a href="{{ base_path }}{{ routes.configuration | default: '/docs/configuration/' }}" {% if page.url contains 'configuration' %}class="active"{% endif %}>{{ t.configuration }}</a></li>
    </ul>

    <h3>{{ t.core_concepts }}</h3>
    <ul>
        <li><a href="{{ base_path }}{{ routes.routing | default: '/docs/routing/' }}" {% if page.url contains 'routing' %}class="active"{% endif %}>{{ t.routing }}</a></li>
        <li><a href="{{ base_path }}{{ routes.middleware | default: '/docs/middleware/' }}" {% if page.url contains 'middleware' %}class="active"{% endif %}>{{ t.middleware | default: 'Middleware' }}</a></li>
        <li><a href="{{ base_path }}{{ routes.requests_responses | default: '/docs/requests-responses/' }}" {% if page.url contains 'requests-responses' %}class="active"{% endif %}>{{ t.requests_responses }}</a></li>
        <li><a href="{{ base_path }}{{ routes.container | default: '/docs/container/' }}" {% if page.url contains 'container' %}class="active"{% endif %}>{{ t.container }}</a></li>
    </ul>

    <h3>{{ t.features }}</h3>
    <ul>
        <li><a href="{{ base_path }}{{ routes.security | default: '/docs/security/' }}" {% if page.url contains 'security' %}class="active"{% endif %}>{{ t.security }}</a></li>
        <li><a href="{{ base_path }}{{ routes.events | default: '/docs/events/' }}" {% if page.url contains 'events' %}class="active"{% endif %}>{{ t.events }}</a></li>
        <li><a href="{{ base_path }}{{ routes.validation | default: '/docs/validation/' }}" {% if page.url contains 'validation' %}class="active"{% endif %}>{{ t.validation }}</a></li>
        <li><a href="{{ base_path }}{{ routes.database | default: '/docs/database/' }}" {% if page.url contains 'database' %}class="active"{% endif %}>{{ t.database }}</a></li>
    </ul>

    <h3>{{ t.extensions | default: 'Extensions' }}</h3>
    <ul>
        <li><a href="{{ base_path }}{{ routes.extensions | default: '/docs/extensions/' }}" {% if page.url == routes.extensions or page.url == '/docs/extensions/' %}class="active"{% endif %}>{{ t.overview | default: 'Overview' }}</a></li>
        <li><a href="{{ base_path }}{{ routes.extensions_cycle_orm | default: '/docs/extensions/cycle-orm/' }}" {% if page.url contains '/extensions/cycle-orm' %}class="active"{% endif %}>Cycle ORM</a></li>
    </ul>

    <h3>{{ t.advanced }}</h3>
    <ul>
        <li><a href="{{ base_path }}{{ routes.providers | default: '/docs/providers/' }}" {% if page.url contains 'providers' %}class="active"{% endif %}>{{ t.providers }}</a></li>
        <li><a href="{{ base_path }}{{ routes.testing | default: '/docs/testing/' }}" {% if page.url contains 'testing' %}class="active"{% endif %}>{{ t.testing }}</a></li>
        <li><a href="{{ base_path }}{{ routes.deployment | default: '/docs/deployment/' }}" {% if page.url contains 'deployment' %}class="active"{% endif %}>{{ t.deployment }}</a></li>
        <li><a href="{{ base_path }}{{ routes.benchmarks | default: '/docs/benchmarks/' }}" {% if page.url contains 'benchmarks' %}class="active"{% endif %}>Performance Benchmarks</a></li>
    </ul>

    <h3>Resources</h3>
    <ul>
        <li><a href="{{ site.github_url }}/pivotphp-core" target="_blank">GitHub →</a></li>
        <li><a href="{{ site.github_url }}/pivotphp-core/releases" target="_blank">Changelog →</a></li>
        <li><a href="https://packagist.org/packages/pivotphp/core" target="_blank">Packagist →</a></li>
    </ul>
</aside>